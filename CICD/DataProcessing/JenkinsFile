pipeline {
    agent any  // 이 파이프라인이 실행될 Jenkins 에이전트를 지정합니다. 'any'는 사용 가능한 임의의 에이전트에서 실행될 수 있음을 의미합니다.
    
    stages {
        stage('Build and Deploy Hadoop') {
            steps {
                script {
                    echo "하둡 컨테이너 실행 상태 확인 중..."
                    def isHadoopRunning = sh(script: "docker ps --filter name=nowdoboss_hadoop --filter status=running", returnStdout: true).trim()
                    echo "하둡 실행 상태: ${isHadoopRunning}"

                    // 하둡이 실행 중이지 않으면 실행
                    if (isHadoopRunning == "") {
                        sh "docker-compose -f up -d"
                    }
                }
            }
        }

    }
}
